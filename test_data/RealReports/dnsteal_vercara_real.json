{
    "attributes": [],
    "created": "2025-04-24T09:00:00",
    "id": "real_dnsteal_vercara",
    "news_items": [
      {
        "author": "Michael Smith",
        "content": "An Introduction to DNS Tunneling Detection & Data Exfiltration Via DNS\n\nIn February, we released Vercara UltraDNS Detection and Response, or UltraDDR.  This is a filtering DNS resolver powered by a decision engine that is powered by a vast data lake of attacker DNS infrastructure making it the highest efficacy product on the market.  As soon as we launched the product, we had customers asking about our ability to detect and block data exfiltration and tunneling via DNS.  Detecting this kind of activity and blocking it is one of the most powerful features of UltraDDR and it is something that we do better than any other solution. \n\nThe concept behind basic DNS file exfiltration is fairly straightforward.  DNS is a protocol that enterprises must allow outbound access for, so firewalls typically allow outbound connections on UDP port 53 to DNS servers. DNS exfiltration takes advantage of this by encoding data that the attacker wants to exfiltrate inside legitimate-looking DNS traffic. A malicious authoritative DNS server deployed on the internet can extract the data from the DNS traffic it receives effectively evading enterprise defenses. \n\nTo extract data via DNS, and given a file that you want to extract, attackers perform the following steps: \n\n    Set up a domain and authoritative DNS server to receive queries \n    Encrypt the data that they want to exfiltrate (optional) \n    Encode the data into a character set that is DNS-compatible (0-9, a-z) \n    Break the encoded data into “chunks” that are 53 characters or less in length \n    Prepend each chunk to a domain to make a Fully-Qualified Domain Name (FQDN) \n    Query for each FQDN against a local recursive DNS server that will forward the queries to the authoritative DNS \n    Receive each query on the authoritative DNS and reverse the process to extract the file. \n\nTunneling works similarly except that instead of transferring files, the attacker transfers network packets or HTTP requests.  To do tunneling or more advanced exfiltration, both the endpoint tool and the authoritative DNS server have to understand flow control, meta-commands, and even how to encode TCP into DNS. \nData Exfiltration Through DNS That Is in Use Today. \n\nNot only is DNS exfiltration and tunneling possible but it’s also used today because it works. DNS queries are common on networks and in such a volume that it’s hard to inspect them all individually, much less correlate activity across multiple queries. \n\nThere are many tools that do DNS exfiltration and tunneling: \n\n    DNS Steal https://github.com/m57/dnsteal  \n    Iodine https://code.kryo.se/iodine/  \n    Dns2TCP https://www.aldeid.com/wiki/Dns2tcp  \n    DNSCat https://github.com/iagox86/dnscat2  \n    Arecibo https://www.tarlogic.com/blog/arecibo-exfiltration-tool/  \n    And many others \n\nMITRE ATT&CK is an enumeration of cyberattackers, tools, and techniques. The technique T1071.004 https://attack.mitre.org/techniques/T1071/004/ explains exfiltration, tunneling, and command and control (C2) over DNS and lists over 45 tools, malware families, and attacker groups that use it. \nApplication Layer Protocol: DNS\n\nT1071.004 also lists 2 mitigation methods, of which M1071 is directly relevant to UltraDDR: \n\n“Consider filtering DNS requests to unknown, untrusted, or known bad domains and resources. Resolving DNS requests with on-premises/proxy servers may also disrupt adversary attempts to conceal data within DNS packets.” \nAuditors Are Checking for DNS Tunneling & Data Exfiltration. \n\nOnce attacker techniques and tools get added to ATT&CK, they also get added to the playbooks for red and purple teams.  In simulating attacker behavior, testers will check to see if they can use DNS for exfiltration and tunneling, if it is blocked by security controls, and if it is detected by the blue team and SOC operations staff. \n\nThis also means that DNS exfiltration and tunneling end up as audit findings and risks and these get put into risk registers so that it is tracked, monitored, and addressed within the organization’s overall risk management process.  It has been incredibly common over the past 2 years that organizations have been looking for preventative control for DNS exfiltration and tunneling. \nUltraDDR Detects and Blocks DNS Tunnel & Data Exfiltration Traffic\n\nAnd that brings us full circle to UltraDDR and what our customers are asking for: detection and blocking of DNS exfiltration and tunneling. UltraDDR is designed to protect networks and endpoints by blocking, or redirecting, malicious DNS requests such as phishing, malware distribution, command-and-control communication, data exfiltration, and DNS tunneling.  \n\nUltraDDR is powered by an adversarial infrastructure data lake that is a large-scale repository of historical and real-time data that contains information about known malicious domains, IP addresses, command-and-control servers, malware signatures, and other indicators of compromise (IOCs) collected from various sources, such as previous attacks, threat intelligence feeds, and security research. \n\nIn the next blog post of this series, we will discuss how UltraDDR detects and blocks DNS exfiltration and tunneling. And in the last of the series, we will discuss testing the detection and demo a tool that written to simulate exfiltration. \nPublished On: July 17, 2023\nLast Updated: March 14, 2024",
        "hash": "",
        "id": "real_dnsteal_vercara",
        "link": "https://vercara.digicert.com/resources/an-introduction-to-data-exfiltration-and-tunneling-via-dns",
        "osint_source_id": "real_dnsteal_vercara",
        "published": "2023-07-17T00:00:00",
        "source": "https://vercara.digicert.com",
        "story_id": "real_dnsteal_vercara",
        "title": "An Introduction to DNS Tunneling Detection & Data Exfiltration Via DNS"
      }
    ],
    "tags": {},
    "title": "An Introduction to DNS Tunneling Detection & Data Exfiltration Via DNS"
}
