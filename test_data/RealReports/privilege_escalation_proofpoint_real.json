{
    "attributes": [],
    "created": "2025-04-24T11:00:00",
    "id": "real_privilege_escalation_purplesec",
    "news_items": [
      {
        "author": "Joshua Selvidge",
        "content": "Privilege Escalation Attacks: Types, Examples, And Prevention\n\nPrivilege escalation attacks exploit weaknesses and security vulnerabilities with the goal of elevating access to a network, applications, and mission-critical systems.\n\nThere are two types of privilege escalation attacks including vertical and horizontal.\n\n    Vertical attacks are when an attacker gains access to an account with the intent to perform actions as that user.\n    Horizontal attacks gain access to account(s) with limited permissions requiring an escalation of privileges, such as to an administor role, to perform the desired actions.\n\nIn this article, I’m going to discuss privilege escalation in-depth along with how it’s used to exploit different operating systems.\n\nNext, I’ll show you 5 real-world examples of how a threat actor can elevate their permissions or gain access to an account with elevated permissions.\n\nLastly, I’ll share how your business can prevent these types of attacks from compromising your network.\nFree Security Policy Templates\n\nGet a step ahead of your cybersecurity goals with our comprehensive templates.\nDownload Now\nWhat Is A Privilege Escalation Attack?\n\nPrivilege escalation is an attack vector that many businesses face due to loss of focus on permission levels.\n\nAs a result, security controls are not sufficient to prevent a privilege escalation.\n\nPrivilege escalation attacks occur when a threat actor gains access to an employee’s account, bypasses the proper authorization channel, and successfully grants themselves access to data they are not supposed to have.\n\nWhen deploying these attacks threat actors are typically attempting to exfiltrate data, disrupt business functions, or create backdoors.\n\nAll of these actions can have a major impact on business continuity and should be considered when drafting a business continuity plan.\n\nWhen encountering a privilege escalation attack, how you respond is critical.\n\nHere are a few questions to consider:\n\n    What did the attacker have permission and access to?\n    How are business services currently being impacted?\n    What other activities were performed on this account during the duration of the attack?\n\nWhat Are The Types Of Privilege Escalation Attacks?\n\nNot every attack will provide threat actors with full access to the targeted system.\n\nIn these cases, a privilege escalation is required to achieve the desired outcome. There are two types of privilege escalation attacks including vertical and horizontal.\nVertical Privilege Escalation\n\nVertical privilege escalation occurs when an attacker gains access directly to an account with the intent to perform actions as that person.\n\nThis type of attack is easier to pull off since there is no desire to elevate permissions.\n\nThe goal here is to access an account to further spread an attack or access data the user has permission to.\n\nDay in and day out I analyze numerous phishing emails that attempt to perform this attack.\n\nWhether it’s a “bank”, “Amazon”, or any other countless number of e-commerce sites, the attack is the same.\n\n    Your account will be deactivated due to inactivity. Please click this link and login to keep your account active.\n\nThis is, however, one example of many cookie-cutter phishing templates seen in “the wild”.\nHorizontal Privilege Escalation\n\nHorizontal privilege escalation is a bit tricky to pull off as it requires the attacker to gain access to the account credentials as well as elevating the permissions.\n\nThis type of attack tends to require a deep understanding of the vulnerabilities that affect certain operating systems or the use of hacking tools.\n\nPhishing campaigns have been used to perform the first part of the attack to gain access to the account.\n\nWhen it comes to elevating permissions, the attacker has a few options to choose from.\n\nOne option is to exploit vulnerabilities in the operating system to gain system or root-level access.\n\nThe next option would be to use hacking tools, like Metasploit, to make the job a bit easier.\nExamples Of Privilege Escalation Attacks\n\nNow that you have a better understanding of what a privilege escalation attack is, I’m going to show you 5 real-world examples including:\n\n    Windows Sticky Keys\n    Windows Sysinternals\n    Process Injection\n    Linux Passwd User Enumeration\n    Android Metasploit\n\n1. Windows Sticky Keys\n\nWhen attempting a privilege escalation attack on Windows, I like to start with a “sticky key” attack.\n\nThis attack is fairly easy to perform and does not require any sort of advanced skillset to pull it off.\n\nTo perform this attack you will need physical access to the machine and the ability to boot to a repair disk.\n\nOnce booted, you will have to change the system file associated with the sticky key function (tapping the shift key 5 times).\n\nFrom a command prompt, you will make a copy of the <sethc.exe> file located at %systemroot%\\system32.\n\nNext, all you have to do is copy the <cmd.exe> to %systemroot%\\system32 with the file name <sethc.exe>.\n\nAfter the command prompt’s executable has been saved to the correct location, reboot.\n\nOnce at the logon screen, tap the shift key 5 times to activate “sticky keys” and you should be presented with a command prompt with system level access.\n\nFrom this level of access, an attacker can create a backdoor in to the system by creating a local administrator account.\n2. Windows Sysinternals\n\nAnother common method of privilege escalation in windows is through the use of the Sysinternals tool suite.\n\nAfter an attacker gains a backdoor into the system using the “Sticky Keys” method, they can further escalate their privileges to system access.\n\nThis attack method requires the use of the Psexec command as well as local administrative rights to the machine.\n\nAfter logging in with the backdoor account, which in my case is “fakeadmin”, I simply use the psexec.exe tool to escalate my permissions to system access.\n\nThis is done by using the command “psexec.exe –s cmd”.\n3. Process Injection\n\nWorking against weak processes is another method that I use for privilege escalation.\n\nOne tool that I have seen used in penetration testing is Process Injector.\n\nThis tool has the capability to enumerate all running processes on a system as well as the account running the process.\n\nIn order to pull this attack off, you will need access to an account with higher permission levels.\n\nAfter you identify the process you want to inject into, for example, cmd.exe, run a command like pinjector.exe –p <PID of the account you want to mimick permissions from> cmd.exe <port>.\n4. Linux Passwd User Enumeration\n\nA basic privilege escalation attack that is common in Linux is conducted through enumerating the user accounts on the machine.\n\nThis attack requires the attacker to access the shell of the system. This is commonly done through misconfigured ftp servers.\n\nOnce the attacker has gained access to the shell, the command “cat /etc/passwd | cut –d: -f1” will list all users on the machine.\n5. Android And Metasploit\n\nMetasploit is a well-known tool to most hackers and contains a library of known exploits.\n\nIn the case of Android devices, Metasploit can be used against rooted Android devices.\n\nOnce an Android device is rooted a SU binary becomes available which allows commands to be ran as root.\n\nThe example below shows how this exploit can be ran to run “show options” and “show advanced” as root.\n\nHow To Prevent A Privilege Escalation Attack\n\nUnfortunately, users are the weakest link in the security chain. With just a single click, they could compromise a system or network.\n\nTo mitigate this risk, businesses implement security awareness programs along with a methodology for validating the effectiveness of the training.\n\nIn most cases, phishing simulation software, like KnowBe4, GoPhish, or Phishme can adequately train users to identify phishing email attempts.\n\nPrivilege escalation, like other cyber attacks, takes advantage of system and process vulnerabilities.\n\nIn order to prevent these attacks, consider implementing proper processes for patch management, new software development/implementation, and user account modification requests as well as an automated tool to monitor for such changes.\n\nImplementing these process will give you the proper safeguards in place to prevent or deter and attacker from attempting privilege escalation.\n\nFinally, an intrusion detection system (IDS) and/or intrusion prevention system (IPS) provide an additional layer of security to derail attempts at escalating privileges.\n\nNew exploits are being created daily and it is our responsibility to ensure we protect ourselves from the attack.\n\nA proper patch management process will help ensure all systems and applications are current with the latest patches.\n\nDuring the quest for new and improved software, we must not forget to include security in the process.\n\nOftentimes, security is set aside to meet the business or client needs.\n\nSoftware code reviews or vendor management processes will help keep security in the loop and strengthen your development practices.\n\nDuring the attack, the attacker may try to elevate their permissions with a phone call or service ticket request to the helpdesk.\n\nWithout a proper process in place to validate the user’s request, this may go unnoticed until an access level review is conducted.\nWhat Can You Do During An Incident?\n\nIn the event, you find yourself faced with this type of attack, it is important to isolate the incident first.\n\nIf you have detected the account that was compromised, change the password and disable the account.\n\nCheck the system and disable any abnormal accounts and reset all user account passwords that have been associated with that machine.",        
        "hash": "",
        "id": "real_privilege_escalation_purplesec",
        "link": "https://purplesec.us/learn/privilege-escalation-attacks/",
        "osint_source_id": "real_privilege_escalation_purplesec",
        "published": "2024-03-31T00:00:00",
        "source": "https://purplesec.us",
        "story_id": "real_privilege_escalation_purplesec",
        "title": "Privilege Escalation Attacks: Types, Examples, And Prevention"
      }
    ],
    "tags": {},
    "title": "Privilege Escalation Attacks: Types, Examples, And Prevention"
}